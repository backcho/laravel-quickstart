# 05. 서비스 공개 (ngrok)

> 목표: 로컬 개발 환경을 외부에서 접근 가능하게 공개

MVP를 만들었다면 피드백을 받아야 합니다. 아직 서버에 배포하기 전, ngrok을 사용하면 로컬 환경을 외부에 임시로 공개할 수 있습니다.

---

## 1. ngrok

### ngrok이란?

로컬 서버를 인터넷에 공개해주는 터널링 서비스입니다. 무료로 시작할 수 있습니다.

### 설치

#### 회원가입

1. [https://ngrok.com](https://ngrok.com) 접속
2. 무료 회원가입
3. Dashboard에서 Authtoken 확인

#### Mac

```bash
# Homebrew로 설치
brew install ngrok

# 또는 직접 다운로드
# https://ngrok.com/download
```

#### Windows

1. [https://ngrok.com/download](https://ngrok.com/download)에서 다운로드
2. 압축 해제
3. ngrok.exe를 원하는 경로에 배치 (예: `C:\ngrok\`)
4. 시스템 환경 변수 PATH에 추가 (선택)

### 인증 설정

```bash
ngrok config add-authtoken YOUR_AUTH_TOKEN
```

### 사용법

```bash
# Herd/Laragon 사용 시 (기본 포트 80)
ngrok http 80

# artisan serve 사용 시
ngrok http 8000

# 특정 도메인으로 터널링 (Herd/Valet)
ngrok http --host-header=my-project.test 80
```

### 실행 결과

```
Session Status                online
Account                       your-email@example.com
Version                       3.x.x
Region                        Asia Pacific (ap)
Forwarding                    https://abc123.ngrok-free.app -> http://localhost:80

Connections                   ttl     opn     rt1     rt5     p50     p90
                              0       0       0.00    0.00    0.00    0.00
```

**Forwarding URL** (`https://abc123.ngrok-free.app`)을 공유하면 됩니다!

### 주의사항

#### 무료 플랜 제한
- 세션당 URL이 변경됨 (매번 다른 URL)
- 동시 연결 1개
- 분당 요청 수 제한
- ngrok 브랜딩 페이지가 먼저 표시됨

#### Laravel 설정

```env
# .env에서 APP_URL 설정 (선택)
APP_URL=https://abc123.ngrok-free.app

# 세션 도메인 설정 (쿠키 문제 해결)
SESSION_DOMAIN=.ngrok-free.app
```

#### TrustProxies 설정

```php
// app/Http/Middleware/TrustProxies.php
// Laravel 11+에서는 bootstrap/app.php에서 설정

protected $proxies = '*';
```

---

## 2. Expose (대안)

### Expose란?

Laravel 팀 멤버가 만든 PHP 기반 터널링 도구입니다.

### 설치

```bash
composer global require beyondcode/expose
```

### 사용법

```bash
# 기본 사용
expose share http://my-project.test

# 서브도메인 지정 (유료)
expose share http://my-project.test --subdomain=my-mvp
```

### 장점
- Laravel 생태계
- PHP로 작성되어 Laravel 친화적
- 로컬에서 자체 서버 실행 가능

### 단점
- 무료 플랜 제한적
- ngrok보다 속도가 느릴 수 있음

---

## 3. Cloudflare Tunnel (대안)

### cloudflared란?

Cloudflare에서 제공하는 무료 터널링 서비스입니다.

### 설치

#### Mac
```bash
brew install cloudflared
```

#### Windows
[https://developers.cloudflare.com/cloudflare-one/connections/connect-apps/install-and-setup/installation/](https://developers.cloudflare.com/cloudflare-one/connections/connect-apps/install-and-setup/installation/)

### 사용법

```bash
# 빠른 터널 (계정 없이)
cloudflared tunnel --url http://localhost:80

# 또는
cloudflared tunnel --url http://my-project.test
```

### 장점
- 완전 무료 (계정 없이도 사용 가능)
- 빠른 속도 (Cloudflare CDN)
- 브랜딩 페이지 없음

### 단점
- URL이 길고 복잡함
- 매번 URL 변경됨

---

## 4. MVP 피드백 받기

### 테스트 계정 준비

외부에 공유하기 전에 테스트용 계정을 미리 만들어두세요.

```bash
php artisan tinker
```

```php
// 일반 사용자 계정
\App\Models\User::create([
    'name' => 'Test User',
    'email' => 'test@example.com',
    'password' => bcrypt('password123'),
])->assignRole('user');

// 관리자 계정
\App\Models\User::create([
    'name' => 'Test Admin',
    'email' => 'admin@example.com',
    'password' => bcrypt('password123'),
])->assignRole('admin');
```

### URL 공유 시 주의사항

1. **세션 유지**: ngrok 무료 플랜은 세션 종료 시 URL이 변경됩니다. 터미널을 닫지 마세요.

2. **테스트 계정 안내**: URL과 함께 테스트 계정 정보를 공유하세요.
   ```
   MVP 테스트 링크: https://abc123.ngrok-free.app
   
   테스트 계정:
   - 일반 사용자: test@example.com / password123
   - 관리자: admin@example.com / password123
   ```

3. **피드백 수집 방법**:
   - Google Forms
   - Notion 페이지
   - 간단한 피드백 폼 직접 구현
   - 카카오톡/슬랙 채널

### 피드백 체크리스트

공유할 때 확인받고 싶은 항목을 정리해두세요:

- [ ] 회원가입/로그인이 잘 되나요?
- [ ] 게시글 작성/수정/삭제가 정상 동작하나요?
- [ ] (관리자) 대시보드 통계가 보이나요?
- [ ] (관리자) 회원 목록과 역할 변경이 되나요?
- [ ] UI/UX에서 불편한 점이 있나요?
- [ ] 추가로 필요한 기능이 있나요?

---

## 5. 비교 정리

| 도구 | 무료 제한 | 설치 난이도 | 속도 | 추천 상황 |
|------|-----------|-------------|------|-----------|
| ngrok | 세션당 URL 변경 | 쉬움 | 빠름 | 일반적인 MVP 테스트 |
| Expose | 제한적 | 쉬움 | 보통 | Laravel 프로젝트 |
| cloudflared | 거의 없음 | 보통 | 매우 빠름 | 장시간 테스트 |

---

## 6. 다음 단계: 실제 배포

MVP 피드백을 받고 서비스가 검증되었다면, 실제 서버에 배포할 차례입니다.

### 저비용 배포 옵션

- **Vultr / DigitalOcean / Linode**: 월 $5~6부터
- **AWS Lightsail**: 월 $3.5부터
- **Laravel Forge**: 서버 관리 자동화 (월 $12 + 서버 비용)
- **Laravel Vapor**: 서버리스 (월 $39 + AWS 비용)

### 무료 옵션 (제한적)

- **Railway**: 무료 크레딧 제공
- **Render**: 무료 티어 있음 (슬립 모드)
- **Fly.io**: 무료 티어 있음

---

## 다음 단계

서비스를 외부에 공개했습니다! [06_보너스_UI커스텀.md](./06_보너스_UI커스텀.md)에서 UI를 커스터마이징하는 방법을 알아봅니다.
